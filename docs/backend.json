
{
  "entities": {
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project, either pre-existing or custom-built.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the project."
        },
        "title": {
          "type": "string",
          "description": "The title of the project."
        },
        "category": {
          "type": "string",
          "description": "The category the project belongs to (e.g., IoT, Hardware, Software, AI)."
        },
        "price": {
          "type": "number",
          "description": "The price of the project."
        },
        "difficulty": {
          "type": "string",
          "description": "The difficulty level of the project (e.g., Beginner, Intermediate, Advanced)."
        },
        "image": {
          "type": "string",
          "description": "URL or path to the project's image.",
          "format": "uri"
        },
        "tags": {
          "type": "array",
          "description": "Keywords associated with the project.",
          "items": {
            "type": "string"
          }
        },
        "description": {
          "type": "string",
          "description": "A brief description of the project."
        }
      },
      "required": [
        "id",
        "title",
        "category",
        "price",
        "difficulty",
        "description"
      ]
    },
    "CustomOrder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CustomOrder",
      "type": "object",
      "description": "Represents a custom order request from a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the custom order request."
        },
        "fullName": {
          "type": "string",
          "description": "The full name of the user placing the order."
        },
        "contactEmail": {
          "type": "string",
          "description": "The email address of the user.",
          "format": "email"
        },
        "projectTitle": {
          "type": "string",
          "description": "The user-provided title or concept for the project."
        },
        "domain": {
          "type": "string",
          "description": "The domain or category of the project (e.g., Embedded Systems, IoT)."
        },
        "deadline": {
          "type": "string",
          "description": "The requested deadline for the project completion.",
          "format": "date-time"
        },
        "detailedRequirements": {
          "type": "string",
          "description": "A detailed description of the project requirements and specifications."
        }
      },
      "required": [
        "id",
        "fullName",
        "contactEmail",
        "projectTitle",
        "domain",
        "detailedRequirements"
      ]
    },
    "Employee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Employee",
      "type": "object",
      "description": "Represents an employee with their details.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Full name of the employee."
        },
        "age": {
          "type": "number",
          "description": "Age of the employee."
        },
        "position": {
          "type": "string",
          "description": "The job position or title of the employee."
        },
        "specialization": {
          "type": "string",
          "description": "The primary area of expertise or specialization."
        }
      },
      "required": [
        "name",
        "age",
        "position",
        "specialization"
      ]
    },
    "Consultation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Consultation",
      "type": "object",
      "description": "Represents a consultation request from a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the consultation request."
        },
        "customerName": {
          "type": "string",
          "description": "Full name of the user requesting the consultation."
        },
        "customerEmail": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "preferredTime": {
          "type": "string",
          "description": "The user's preferred time for the meeting."
        },
        "assignedTo": {
          "type": "string",
          "description": "The team member assigned to this consultation."
        },
        "createdAt": {
          "type": "string",
          "description": "The timestamp when the consultation was requested.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "customerName",
        "customerEmail",
        "preferredTime",
        "createdAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/backend/entities/Project"
          },
          "description": "Stores project data for the application. Anyone can read the projects, and only admins can create or modify them.",
          "params": [
            {
              "name": "projectId",
              "description": "Unique identifier for the project."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/customOrders/{customOrderId}",
        "definition": {
          "entityName": "CustomOrder",
          "schema": {
            "$ref": "#/backend/entities/CustomOrder"
          },
          "description": "Stores custom order requests submitted by users. Path-based ownership, authorization depends on `request.auth.uid == userId`.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier of the user who placed the order."
            },
            {
              "name": "customOrderId",
              "description": "Unique identifier for the custom order request."
            }
          ]
        }
      },
      {
        "path": "/employees/{employeeId}",
        "definition": {
          "entityName": "Employee",
          "schema": {
            "$ref": "#/backend/entities/Employee"
          },
          "description": "Stores employee details. Only the Super Admin can read and write to this collection.",
          "params": [
            {
              "name": "employeeId",
              "description": "Unique identifier for the employee."
            }
          ]
        }
      },
      {
        "path": "/consultations/{consultationId}",
        "definition": {
          "entityName": "Consultation",
          "schema": {
            "$ref": "#/backend/entities/Consultation"
          },
          "description": "Stores consultation requests submitted by users. Anyone can create, but only admins can read/update.",
          "params": [
            {
              "name": "consultationId",
              "description": "Unique identifier for the consultation request."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure is designed to manage project data and custom orders for the NAFON AI Lab application, ensuring security, scalability, and efficient data retrieval. It is tailored to support features like browsing projects, submitting custom orders, and leveraging AI assistance. The design follows the core principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), QAPs (Rules are not Filters), and Invariants.\n\n**Authorization Independence:** Authorization Independence is achieved through path-based ownership for user-submitted data and the exclusion of authorization-dependent `get()` calls in security rules. This is because the application relies on public data, and the users only have access to create their custom orders, stored via path-based ownership.\n\n**DBAC:** The application does not require specific roles besides the user's own id, since it handles public data and custom orders which can be managed with rules based on `request.auth.uid`.\n\n**QAPs:** The structure supports secure `list` operations because the data is segregated. The projects are global and do not rely on user ownership. The custom orders are stored by path-based ownership and can be filtered using the user ID, not relying on filtering the data in the security rules."
  }
}
